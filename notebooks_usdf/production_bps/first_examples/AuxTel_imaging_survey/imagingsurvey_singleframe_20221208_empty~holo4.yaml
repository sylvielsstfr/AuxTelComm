pipelineYaml: '$DRP_PIPE_DIR/pipelines/LATISS/DRP.yaml#isr,characterizeImage,calibrate,writeSourceTable,transformSourceTable'

# Just names, but UPDATE THIS AND KEEP THEM SHORT
project: IMAGING_SPECTRO
campaign: dec2022

# UPDATE THESE arguments to mirror the ones you use with command-line pipetask run
payload:
  payloadName: 'imaging_20221208_empty~holo4'
  butlerConfig: /repo/embargo
  inCollection: LATISS/raw/all,refcats,LATISS/calib
  dataQuery: "instrument='LATISS' AND exposure.day_obs=20221208 AND exposure.seq_num IN (43,44,48,49,53,54,63,64,68,69,73,74,83,84,91,92,97,98,102,103,107,108,112,113,117,118,122,123,128,129,133,134,141,142,149,150,154,155,159,160,164,165,169,170,174,175,179,180,189,190,194,195,199,200,204,205,209,210,214,215,219,220,224,225,236,237,241,242,246,247,254,255,259,260,264,265,269,270,279,280,284,285,290,291)"
  runPreCmdOpts: --long-log --log-level timer.lsst.resources=DEBUG 

wmsServiceClass: lsst.ctrl.bps.parsl.ParslService
computeSite: slurm

parsl:
  log_level: INFO

site:
  slurm:
    class: lsst.ctrl.bps.parsl.sites.Slurm
    nodes: 2
    walltime: '2:00:00'     # This is 2 hours
    cores_per_node: 100
    qos: normal
    scheduler_options: |
      #SBATCH --partition=roma
      #SBATCH --exclusive
  triple_slurm:
    class: lsst.ctrl.bps.parsl.sites.TripleSlurm
    nodes: 1
    cores_per_node: 100
    qos: normal
    small_memory: 2.0     # Units are GB
    medium_memory: 4.0
    large_memory: 8.0
    small_walltime: '10.0'   # Units are hours
    medium_walltime: '10.0'
    large_walltime: '40.0'        
  work_queue:
    class: lsst.ctrl.bps.parsl.sites.work_queue.LocalSrunWorkQueue
    worker_options: "--memory=480000"   # work_queue expects memory in MB
    nodes_per_block: 10

    monitorEnable: true
    monitorFilename: monitoring.db

